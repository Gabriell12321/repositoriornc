<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê Permiss√µes de Campos RNC - IPPEL</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/field_locks_premium.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Gerenciar Permiss√µes de Campos RNC</h1>
            <p>Configure quais campos cada grupo pode editar na cria√ß√£o de RNCs. Clique nos campos para bloquear/desbloquear o acesso.</p>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <h3>üë• Grupos</h3>
                <input type="text" class="search-box" id="groupSearch" placeholder="Buscar grupo...">
                <ul class="group-list" id="groupList">
                    <!-- Grupos ser√£o carregados via JavaScript -->
                </ul>
            </div>

            <div class="content-area">
                <div id="loading" class="loading">
                    <p>Selecione um grupo na lista ao lado para configurar as permiss√µes de campos</p>
                </div>

                <div id="groupContent" style="display: none;">
                    <h3 id="groupTitle">Configura√ß√µes do Grupo</h3>
                    
                    <!-- Abas de Contexto: Cria√ß√£o vs Resposta -->
                    <div class="context-tabs">
                        <button class="context-tab active" data-context="creation" onclick="switchContext('creation')">
                            <span>üÜï</span> Permiss√µes de Cria√ß√£o
                        </button>
                        <button class="context-tab" data-context="response" onclick="switchContext('response')">
                            <span>üìù</span> Permiss√µes de Resposta
                        </button>
                    </div>
                    
                    <div class="context-description">
                        <p id="contextDesc">
                            <strong>üÜï Permiss√µes de Cria√ß√£o:</strong> Campos que o grupo pode editar ao <strong>criar um novo RNC</strong>
                        </p>
                    </div>
                    
                    <div class="actions-bar">
                        <button class="btn btn-success" onclick="saveChanges()">
                            <span>üíæ</span> Salvar Altera√ß√µes
                        </button>
                        <button class="btn btn-primary" onclick="unlockAll()">
                            <span>üîì</span> Liberar Todos
                        </button>
                        <button class="btn btn-warning" onclick="lockAll()">
                            <span>üîí</span> Bloquear Todos
                        </button>
                        <button class="btn btn-danger" onclick="resetGroup()">
                            <span>üóëÔ∏è</span> Resetar Grupo
                        </button>
                    </div>

                    <div id="alerts"></div>

                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color unlocked"></div>
                            <span><strong>üîì Campo Liberado</strong> - Clique para bloquear</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color locked"></div>
                            <span><strong>üîí Campo Bloqueado</strong> - Clique para liberar</span>
                        </div>
                    </div>

                    <div class="rnc-form-preview">
                        <div class="section-title">üìã INFORMA√á√ïES PRINCIPAIS DO RNC</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="title">
                                        <div class="field-label">üìù T√≠tulo do RNC</div>
                                        <div class="field-placeholder">Ex: Falha no equipamento de produ√ß√£o - Linha A</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="equipment">
                                        <div class="field-label">üîß Equipamento/Sistema</div>
                                        <div class="field-placeholder">Ex: Linha de montagem A, M√°quina X, Sistema Y</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="client">
                                        <div class="field-label">üè¢ Cliente/Departamento</div>
                                        <div class="field-placeholder">Selecione o cliente</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="description">
                                        <div class="field-label">üìÑ Descri√ß√£o</div>
                                        <div class="field-placeholder">Descreva brevemente o problema identificado</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="priority">
                                        <div class="field-label">‚ö° N√≠vel de Urg√™ncia</div>
                                        <div class="field-placeholder">üî¥ M√©dia - Resolver em at√© 7 dias</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="price">
                                        <div class="field-label">üí∞ Custo Estimado (R$)</div>
                                        <div class="field-placeholder">Custo estimado para corre√ß√£o do impacto financeiro</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">üë• RESPONSABILIDADES E SETORES</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="responsavel">
                                        <div class="field-label">üë§ Respons√°vel pela Detec√ß√£o</div>
                                        <div class="field-placeholder">Nome do funcion√°rio que detectou</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="inspetor">
                                        <div class="field-label">üîç Inspetor</div>
                                        <div class="field-placeholder">Quem identificou o problema</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="assigned_user_id">
                                        <div class="field-label">üìã Atribuir a um Usu√°rio</div>
                                        <div class="field-placeholder">Filtrar por grupos selecionados</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="setor">
                                        <div class="field-label">üè≠ Setor</div>
                                        <div class="field-placeholder">Qual setor onde foi detectado</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="area_responsavel">
                                        <div class="field-label">üìç √Årea/Localiza√ß√£o</div>
                                        <div class="field-placeholder">Ex: Setor de Produ√ß√£o, Cap√≠tulo 1, Piso 2</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">üîß DADOS T√âCNICOS E ESPECIFICA√á√ïES</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="material">
                                        <div class="field-label">üß± Material</div>
                                        <div class="field-placeholder">Descri√ß√£o do material</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="quantity">
                                        <div class="field-label">üìä Quantidade</div>
                                        <div class="field-placeholder">Quantidade envolvida</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="drawing">
                                        <div class="field-label">üìê Desenho</div>
                                        <div class="field-placeholder">N√∫mero do desenho</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="mp">
                                        <div class="field-label">üî¢ MP</div>
                                        <div class="field-placeholder">C√≥digo MP</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="revision">
                                        <div class="field-label">üîÑ Revis√£o</div>
                                        <div class="field-placeholder">N√∫mero da revis√£o</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="position">
                                        <div class="field-label">üìç Posi√ß√£o</div>
                                        <div class="field-placeholder">Posi√ß√£o no desenho</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="cv">
                                        <div class="field-label">üìã CV</div>
                                        <div class="field-placeholder">C√≥digo CV</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="conjunto">
                                        <div class="field-label">üîß Conjunto</div>
                                        <div class="field-placeholder">Nome do conjunto</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="modelo">
                                        <div class="field-label">üéØ Modelo</div>
                                        <div class="field-placeholder">Modelo do equipamento</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="description_drawing">
                                        <div class="field-label">üìù Descri√ß√£o do Desenho</div>
                                        <div class="field-placeholder">Descri√ß√£o detalhada do desenho</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="purchase_order">
                                        <div class="field-label">üõí Ordem de Compra</div>
                                        <div class="field-placeholder">N√∫mero da ordem de compra</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="justificativa">
                                        <div class="field-label">üí≠ Justificativa</div>
                                        <div class="field-placeholder">Justificativa para o RNC</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">üî® INSTRU√á√ïES E AN√ÅLISES</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="instruction_retrabalho">
                                        <div class="field-label">üî® Instru√ß√£o para Retrabalho</div>
                                        <div class="field-placeholder">Descreva as instru√ß√µes detalhadas para o retrabalho</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="cause_rnc">
                                        <div class="field-label">üîé Causa da RNC</div>
                                        <div class="field-placeholder">Descreva a causa raiz da n√£o conformidade</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="action_rnc">
                                        <div class="field-label">‚ö° A√ß√£o a ser Tomada</div>
                                        <div class="field-placeholder">Descreva as a√ß√µes corretivas e preventivas</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">‚úÖ DISPOSI√á√ÉO DO MATERIAL N√ÉO-CONFORME</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_usar">
                                        <div class="field-label">‚úÖ Usar como Est√°</div>
                                        <div class="field-placeholder">Aprovar o uso do material sem altera√ß√µes</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_retrabalhar">
                                        <div class="field-label">üîÑ Retrabalhar</div>
                                        <div class="field-placeholder">Material precisa de retrabalho</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_rejeitar">
                                        <div class="field-label">‚ùå Rejeitar</div>
                                        <div class="field-placeholder">Material rejeitado</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_sucata">
                                        <div class="field-label">üóëÔ∏è Sucata</div>
                                        <div class="field-placeholder">Material ser√° descartado como sucata</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_devolver_estoque">
                                        <div class="field-label">üì¶ Devolver ao Estoque</div>
                                        <div class="field-placeholder">Retornar material ao estoque</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="disposition_devolver_fornecedor">
                                        <div class="field-label">üöö Devolver ao Fornecedor</div>
                                        <div class="field-placeholder">Retornar material ao fornecedor</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">üîç INSPE√á√ÉO DO RETRABALHO</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="inspection_aprovado">
                                        <div class="field-label">‚úÖ Aprovado</div>
                                        <div class="field-placeholder">Retrabalho aprovado</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="inspection_reprovado">
                                        <div class="field-label">‚ùå Reprovado</div>
                                        <div class="field-placeholder">Retrabalho reprovado</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="inspection_ver_rnc">
                                        <div class="field-label">üîó Ver RNC N¬∫</div>
                                        <div class="field-placeholder">Refer√™ncia para outro RNC</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">‚úçÔ∏è ASSINATURAS E APROVA√á√ïES</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_inspection_name">
                                        <div class="field-label">‚úçÔ∏è Assinatura: Respons√°vel</div>
                                        <div class="field-placeholder">Nome do respons√°vel</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_inspection_date">
                                        <div class="field-label">üìÖ Data: Assinatura Respons√°vel</div>
                                        <div class="field-placeholder">Data da assinatura</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_engineering_name">
                                        <div class="field-label">‚úçÔ∏è Assinatura: Gerente</div>
                                        <div class="field-placeholder">Nome do gerente</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_engineering_date">
                                        <div class="field-label">üìÖ Data: Assinatura Gerente</div>
                                        <div class="field-placeholder">Data da assinatura</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_inspection2_name">
                                        <div class="field-label">‚úçÔ∏è Assinatura: L√≠der</div>
                                        <div class="field-placeholder">Nome do l√≠der</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="signature_inspection2_date">
                                        <div class="field-label">üìÖ Data: Assinatura L√≠der</div>
                                        <div class="field-placeholder">Data da assinatura</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">‚öôÔ∏è CAMPOS ADMINISTRATIVOS</div>
                        
                        <div class="form-section">
                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="priority">
                                        <div class="field-label">‚ö†Ô∏è N√≠vel de Urg√™ncia</div>
                                        <div class="field-placeholder">Baixa / M√©dia / Alta / Cr√≠tica</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="status">
                                        <div class="field-label">üìä Status</div>
                                        <div class="field-placeholder">Status atual do RNC</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="price">
                                        <div class="field-label">üí∞ Custo Estimado</div>
                                        <div class="field-placeholder">R$ 0,00</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="field-container">
                                    <div class="field-preview" data-field="rnc_number">
                                        <div class="field-label">üìã N√∫mero RNC</div>
                                        <div class="field-placeholder">Gerado automaticamente</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="created_at">
                                        <div class="field-label">üìÖ Data de Emiss√£o</div>
                                        <div class="field-placeholder">Data de cria√ß√£o do RNC</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                                <div class="field-container">
                                    <div class="field-preview" data-field="assigned_user_id">
                                        <div class="field-label">üë• Usu√°rio Atribu√≠do</div>
                                        <div class="field-placeholder">Selecione o usu√°rio</div>
                                        <div class="field-status"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/field_locks_new.js') }}"></script>
</body>
</html>